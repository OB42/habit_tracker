!function(){function buildOut(){var parent_div=document.getElementById(this.options.wk_id);if(this.weekli=document.createElement("div"),parent_div){var html=buildHTML(this);return this.weekli.appendChild(html.desktop),this.weekli.appendChild(html.mobile),parent_div.appendChild(this.weekli),!0}return console.error("wk_id: "+this.options.wk_id+" element not found"),!1}function mouse_down_cell(evt){var time_attr=(this.getAttribute("data-wk-val"),this.getAttribute("data-wk-hr")),day_attr=this.getAttribute("data-wk-day"),wk_id=evt.target.wk_id;wk_dragging_state=this.classList.contains("available")?"available":"unavailable";for(var cell_match=document.getElementById(wk_id).querySelectorAll("[data-wk-hr= '"+time_attr+"'][data-wk-day= '"+day_attr+"']"),i=0;i<cell_match.length;i++)toggle_state(cell_match[i])}function mouse_hover_cell(evt){var cell_state;if(cell_state=this.classList.contains("available")?"available":"unavailable",wk_dragging&&cell_state===wk_dragging_state)for(var time_attr=this.getAttribute("data-wk-hr"),day_attr=this.getAttribute("data-wk-day"),wk_id=evt.target.wk_id,cell_match=document.getElementById(wk_id).querySelectorAll("[data-wk-hr= '"+time_attr+"'][data-wk-day= '"+day_attr+"']"),i=0;i<cell_match.length;i++)toggle_state(cell_match[i])}function toggle_state(element){element.classList.contains("available")?element.classList.remove("available"):element.classList.add("available")}function change_state(element,state){"available"===state?element.classList.add("available"):element.classList.remove("available")}function table_mousedown(){return wk_dragging=!0,document.getSelection().removeAllRanges(),!1}function time_row_mousedown(evt){for(var wk_id=evt.target.wk_id,time_attr=this.getAttribute("data-wk-time-row"),time_cell_match=document.getElementById(wk_id).querySelectorAll("[data-wk-hr= '"+time_attr+"']"),all_available=!0,i=0;i<time_cell_match.length;i++){if(!time_cell_match[i].classList.contains("available")){all_available=!1;break}all_available=!0}for(var k=0;k<time_cell_match.length;k++)all_available?change_state(time_cell_match[k],"unavailable"):change_state(time_cell_match[k],"available")}function day_column_mousedown(evt){for(var wk_id=evt.target.wk_id,day_attr=this.getAttribute("data-wk-day-col"),day_cell_match=document.getElementById(wk_id).querySelectorAll("[data-wk-day= '"+day_attr+"']"),all_available=!0,i=0;i<day_cell_match.length;i++){if(!day_cell_match[i].classList.contains("available")){all_available=!1;break}all_available=!0}for(var k=0;k<day_cell_match.length;k++)all_available?change_state(day_cell_match[k],"unavailable"):change_state(day_cell_match[k],"available")}function addEvents(){for(var wk_id=this.options.wk_id,wk_cell=document.getElementById(wk_id).getElementsByClassName("wk-cell"),table=document.getElementById(wk_id).getElementsByClassName("weekli"),time_row=document.getElementById(wk_id).getElementsByClassName("wk-time"),day_column=document.getElementById(wk_id).getElementsByClassName("wk-day"),i=0;i<wk_cell.length;i++)wk_cell[i].addEventListener("mousedown",mouse_down_cell,!1),wk_cell[i].addEventListener("mouseover",mouse_hover_cell,!1),wk_cell[i].wk_id=wk_id;for(var j=0;j<table.length;j++)table[j].addEventListener("mousedown",table_mousedown,!1);for(var k=0;k<time_row.length;k++){time_row[k].addEventListener("mousedown",time_row_mousedown,!1),time_row[k].wk_id=wk_id;for(var o=0;o<time_row[k].childNodes.length;o++){time_row[k].childNodes[o].removeEventListener("mousedown",time_row_mousedown,!1),time_row[k].childNodes[o].wk_id=wk_id;for(var p=0;p<time_row[k].childNodes[o].childNodes.length;p++)time_row[k].childNodes[o].childNodes[p].removeEventListener("mousedown",time_row_mousedown,!1),time_row[k].childNodes[o].childNodes[p].wk_id=wk_id}}for(var l=0;l<day_column.length;l++){day_column[l].addEventListener("mousedown",day_column_mousedown,!1),day_column[l].wk_id=wk_id;for(var m=0;m<day_column[l].childNodes.length;m++)day_column[l].childNodes[m].addEventListener("mousedown",day_column_mousedown,!1),day_column[l].childNodes[m].wk_id=wk_id}for(var weekli_div=document.getElementById(wk_id).getElementsByClassName("weekli"),n=0;n<weekli_div.length;n++)weekli_div[n].classList.remove("weekli_uneditable"),weekli_div[n].classList.add("weekli_editable")}function removeEvents(){for(var wk_id=this.options.wk_id,wk_cell=document.getElementById(wk_id).getElementsByClassName("wk-cell"),table=document.getElementById(wk_id).getElementsByClassName("weekli"),time_row=document.getElementById(wk_id).getElementsByClassName("wk-time"),day_column=document.getElementById(wk_id).getElementsByClassName("wk-day"),i=0;i<wk_cell.length;i++)wk_cell[i].removeEventListener("mousedown",mouse_down_cell,!1),wk_cell[i].removeEventListener("mouseover",mouse_hover_cell,!1),wk_cell[i].wk_id=wk_id;for(var j=0;j<table.length;j++)table[j].removeEventListener("mousedown",table_mousedown,!1);for(var k=0;k<time_row.length;k++){time_row[k].removeEventListener("mousedown",time_row_mousedown,!1),time_row[k].wk_id=wk_id;for(var o=0;o<time_row[k].childNodes.length;o++){time_row[k].childNodes[o].removeEventListener("mousedown",time_row_mousedown,!1),time_row[k].childNodes[o].wk_id=wk_id;for(var p=0;p<time_row[k].childNodes[o].childNodes.length;p++)time_row[k].childNodes[o].childNodes[p].removeEventListener("mousedown",time_row_mousedown,!1),time_row[k].childNodes[o].childNodes[p].wk_id=wk_id}}for(var l=0;l<day_column.length;l++){day_column[l].removeEventListener("mousedown",day_column_mousedown,!1),day_column[l].wk_id=wk_id;for(var m=0;m<day_column[l].childNodes.length;m++)day_column[l].childNodes[m].removeEventListener("mousedown",day_column_mousedown,!1),day_column[l].childNodes[m].wk_id=wk_id}for(var weekli_div=document.getElementById(wk_id).getElementsByClassName("weekli"),n=0;n<weekli_div.length;n++)weekli_div[n].classList.remove("weekli_editable"),weekli_div[n].classList.add("weekli_uneditable")}function extendDefaults(source,properties){var property;for(property in properties)properties.hasOwnProperty(property)&&(source[property]=properties[property]);return source}function buildHTML(weekli){var week_type=weekli.options.week,time_range=weekli.options.time_range,minute_interval=weekli.options.minute_interval,time_format=weekli.options.time_format,custom_days=weekli.options.week_days,weekli_days=get_days_array(week_type,custom_days),weekli_hours=get_hour_array(time_range,minute_interval,time_format),desktop_html=buildHTMLdesktop(weekli_days,weekli_hours),mobile_html=buildHTMLmobile(weekli_days,weekli_hours);return{desktop:desktop_html,mobile:mobile_html}}function buildHTMLdesktop(weekli_days,weekli_hours){var table=document.createElement("table");table.className="weekli weekli_desktop";var span_long,span_abbrv,thead=document.createElement("thead"),th=document.createElement("th"),day_abbrv="",day_long="";th.className="wk-day wk-empty",thead.appendChild(th);for(var i=0;i<weekli_days.length;i++)day_long=weekli_days[i],th=document.createElement("th"),th.className="wk-day wk-header",day_abbrv=day_long.substr(0,3),th.setAttribute("data-wk-day-col",day_abbrv.toUpperCase()),span_abbrv=document.createElement("span"),span_abbrv.className="wk-day-abbrv",span_abbrv.innerHTML=day_abbrv,span_long=document.createElement("span"),span_long.className="wk-day-long",span_long.innerHTML=day_long,th.appendChild(span_abbrv),th.appendChild(span_long),thead.appendChild(th);for(var td,tr,day_attr,hour_attr,tbody=document.createElement("tbody"),k=0;k<weekli_hours.length-1;k++){hour_attr=weekli_hours[k].time+" "+weekli_hours[k].am_pm+"-"+weekli_hours[k+1].time+" "+weekli_hours[k+1].am_pm,td=document.createElement("td"),tr=document.createElement("tr"),td.setAttribute("data-wk-time-row",hour_attr),td.innerHTML='<span class="wk-time-span"> '+weekli_hours[k].time+' <span class="wk-ampm">'+weekli_hours[k].am_pm+'</span> </span> - <span class="wk-time-span">'+weekli_hours[k+1].time+' <span class="wk-ampm">'+weekli_hours[k+1].am_pm+"</span> </span>",td.className="wk-time wk-header",tr.appendChild(td);for(var j=0;j<weekli_days.length;j++)day_attr=weekli_days[j].substr(0,3).toUpperCase(),td=document.createElement("td"),td.setAttribute("data-wk-hr",hour_attr),td.setAttribute("data-wk-day",day_attr),td.className="wk-cell",tr.appendChild(td);tbody.appendChild(tr)}return table.appendChild(thead),table.appendChild(tbody),table}function buildHTMLmobile(weekli_days,weekli_hours){var td,tr,th,day_attr,hour_attr,table=document.createElement("table"),tbody=document.createElement("tbody");table.className="weekli weekli_mobile";for(var i=0;i<weekli_days.length;i++){day_attr=weekli_days[i].substr(0,3).toUpperCase(),tr=document.createElement("tr"),th=document.createElement("th"),th.setAttribute("data-wk-day-col",day_attr),th.className="wk-day wk-header",th.colSpan=2,th.innerHTML=weekli_days[i],tr.appendChild(th),tbody.appendChild(tr);for(var k=0;k<weekli_hours.length-1;k++)hour_attr=weekli_hours[k].time+" "+weekli_hours[k].am_pm+"-"+weekli_hours[k+1].time+" "+weekli_hours[k+1].am_pm,tr=document.createElement("tr"),td=document.createElement("td"),td.className="wk-time wk-header",td.innerHTML='<span class="wk-time-span"> '+weekli_hours[k].time+' <span class="wk-ampm">'+weekli_hours[k].am_pm+'</span></span>- <span class="wk-time-span">'+weekli_hours[k+1].time+' <span class="wk-ampm">'+weekli_hours[k+1].am_pm+"</span> </span>",tr.appendChild(td),td=document.createElement("td"),td.setAttribute("data-wk-hr",hour_attr),td.setAttribute("data-wk-day",day_attr),td.className="wk-cell",tr.appendChild(td),tbody.appendChild(tr)}return table.appendChild(tbody),table}function get_days_array(week_type,custom_days){var weekli_days=[];switch(week_type){case"workweek":weekli_days=["Monday","Tuesday","Wednesday","Thursday","Friday"];break;case"weekend":weekli_days=["Saturday","Sunday"];break;case"custom":weekli_days=custom_days;break;default:weekli_days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}return weekli_days}function get_hour_array(time_range,minute_interval,time_format){var weekli_hours=[],hour_interval=Math.floor(minute_interval/60),minutes_interval=minute_interval-60*hour_interval,start_stop=time_range.split(","),start_=start_stop[0].split(":"),stop_=start_stop[1].split(":");start_.length<2&&start_.push("0"),stop_.length<2&&stop_.push("0");for(var print_hour,print_minute,am_pm,start_hour=parseFloat(start_[0]),start_min=parseFloat(start_[1]),stop_hour=parseFloat(stop_[0]),stop_min=parseFloat(stop_[1]),start_time=start_hour+start_min/100,stop_time=stop_hour+stop_min/100,current_time=start_time,current_hour=Math.floor(current_time),current_minute=Math.ceil(Math.round(current_time%1*1e3)/1e3*100);stop_time>current_time;)print_minute=10>current_minute?"0"+current_minute:current_minute,am_pm=12>current_hour?"am":"pm",print_hour="12hour"===time_format&&current_hour>12?current_hour-12:"12hour"===time_format&&0===current_hour?"12":current_hour,weekli_hours.push({time:print_hour+":"+print_minute,am_pm:am_pm}),current_minute+=minutes_interval,current_minute>=60&&(current_minute-=60,current_hour+=1),current_hour+=hour_interval,current_time=current_hour+current_minute/100;return current_minute=Math.ceil(Math.round(stop_time%1*1e3)/1e3*100),print_minute=10>current_minute?"0"+current_minute:current_minute,am_pm=12>current_hour?"am":"pm",current_hour=Math.floor(stop_time),print_hour="12hour"===time_format&&current_hour>12?current_hour-12:"12hour"===time_format&&0===current_hour?"12":current_hour,weekli_hours.push({time:print_hour+":"+print_minute,am_pm:am_pm}),weekli_hours}function loadData(data,weekli){changeAll("unavailable",weekli);for(var wk_id=weekli.options.wk_id,i=0;i<data.available.length;i++)for(var obj=data.available[i],time_attr=obj.time,day_attr=obj.day,cell_match=document.getElementById(wk_id).querySelectorAll("[data-wk-hr= '"+time_attr+"'][data-wk-day= '"+day_attr+"']"),j=0;j<cell_match.length;j++)change_state(cell_match[j],"available")}function changeAll(newvalue,weekli){for(var wk_id=weekli.options.wk_id,cell_match=document.getElementById(wk_id).getElementsByClassName("wk-cell"),j=0;j<cell_match.length;j++)change_state(cell_match[j],newvalue)}this.Weekli=function(){var defaults={wk_id:"weekli",week:"workweek",week_days:[],minute_interval:60,time_range:"7,12",editable:!0,time_format:"12hour"};this.options=extendDefaults(defaults,arguments[0])},Weekli.prototype.build=function(){buildOut.call(this)&&(this.options.editable?addEvents.call(this):removeEvents.call(this))},Weekli.prototype.get_output=function(){for(var wk_id=this.options.wk_id,wk_cell=document.getElementById(wk_id).getElementsByClassName("weekli_desktop")[0].getElementsByClassName("wk-cell"),output={available:[],unavailable:[]},cell_day="",cell_time="",cell_available=!0,cell_tuple={},i=0;i<wk_cell.length;i++)cell_day=wk_cell[i].getAttribute("data-wk-day"),cell_time=wk_cell[i].getAttribute("data-wk-hr"),cell_tuple={day:cell_day,time:cell_time},cell_available=wk_cell[i].classList.contains("available"),cell_available?output.available.push(cell_tuple):output.unavailable.push(cell_tuple);return output},Weekli.prototype.make_uneditable=function(){removeEvents.call(this)},Weekli.prototype.make_editable=function(){addEvents.call(this)},Weekli.prototype.load_data=function(data){loadData(data,this)},Weekli.prototype.all_available=function(){changeAll("available",this)},Weekli.prototype.all_unavailable=function(){changeAll("unavailable",this)};var wk_dragging_state,wk_dragging=!1;document.onmouseup=function(){wk_dragging=!1}}();